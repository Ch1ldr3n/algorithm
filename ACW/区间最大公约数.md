# 题意

给定一个长度为 N 的数列 A，以及 M 条指令，每条指令可能是以下两种之一：

C l r d，表示把 A[l],A[l+1],…,A[r] 都加上 d。

Q l r，表示询问 A[l],A[l+1],…,A[r] 的最大公约数(GCD)。

对于每个询问，输出一个整数表示答案。

输入格式

第一行两个整数 N,M。

第二行 N 个整数 A[i]。

接下来 M 行表示 M 条指令，每条指令的格式如题目描述所示。

输出格式

对于每个询问，输出一个整数表示答案。

每个答案占一行。

数据范围

N≤500000,M≤100000,

1≤A[i]≤1018,

|d|≤1018

输入样例：

5 5

1 3 5 7 9

Q 1 5

C 1 5 1

Q 1 5

C 3 3 6

Q 2 4

输出样例：

1

2

4

## 分析

操作1:区间[l,r]增加一个数

操作2:求区间内的最大公约数

要存的信息：

最大公约数
gcd父 =  gcd(gcd左， gcd右)

(a,b,c) -> (a+x, b+x, c+x) modify一个区间很难，但modify一个点很简单，因为一个数的gcd就是自己

如何把区间修改变成单点修改？ 差分

$(a_1,a_2,...,a_n)=(a_1,a_2-a_1,...,a_n-a_{n-1})$

先证明左$\le$右

d = $(a_1,a_2,...,a_n)$， 则d也能整除右边的每个数，d是右边所有数的公约数，d$\le$最大公约数

再证明右$\le$左：同理

构造$b_i = a_i-a_{i-1}$

{b}是{a}的差分，a是b的前缀和

查询[L,R]：gcd(a[L], gcd(b[L+1]~b[R]))
【这个a[L]通过1～L的sum来求，后面则是L+1～R的gcd】

将区间修改/区间查询转化成单点修改/区间查询
